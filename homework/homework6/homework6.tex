\documentclass{article}
\usepackage{enumerate}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{geometry}
\usepackage{caption}
\usepackage{indentfirst}
\usepackage{multirow}
\geometry{left=3.0cm,right=3.0cm,top=3.0cm,bottom=4.0cm}
\renewcommand{\thesection}{Ex. \arabic{section} ---}
\renewcommand{\mod}{{\rm\ mod\ }}
\title{VE475 Homework 6}
\author{Liu Yihao 515370910207}
\date{}

\begin{document}
\maketitle

\section{Application of the DLP}
\begin{enumerate}
\item
\begin{enumerate}[(a)]
\item
For Alice, she knows that $$\gamma\equiv\alpha^r\mod p$$
If Bob replies $$b\equiv r\mod p-1{\rm\ or\ }b\equiv x+r\mod p-1$$
She can get $$\alpha^{p-1}\equiv 1\mod p$$
$$\alpha^r\equiv\alpha^b\equiv\gamma\mod p{\rm\ or\ }\alpha^r\equiv\alpha^{b-x}\equiv\gamma\mod p$$
So after calculating $\alpha^b\mod p$ or $\alpha^{b-x}\mod p$ and compare it with $\gamma$, she can prove Bob's identity if he replies the correct $b$.
\item 
For Bob, he doesn't know $r$, but he can compute $b=\log_\alpha\gamma$ or $b=\log_\alpha\gamma+x$ so that $b\equiv r\mod p-1$. If he can't do so, it becomes a DLP problem which is very difficult to solve, so he can prove his identity.
\end{enumerate}
\item
\begin{enumerate}[(a)]
\item
\item
\end{enumerate}
\item
It is Digital Signature Protocol.
\end{enumerate}

\section{Pohlig-Hellman}
First, let $g$ be a generator of the group, let $x=\log_gh$, let $n$ be the order of the group, obtain a prime factorization so that $$n=\prod_{i=1}^rp_i^{e_i}$$

Then, for each $i\in\{1,\dots,r\}$, compute $g_i=g^{n/p_i^{e_i}}$, which has order $p_i^{e_i}$, and compute $h_i=h^{n/p_i^{e_i}}$. Then we can use the Pohlig-Hellman algorithm for prime-power order to compute $x_i\in\{0,\dots,p_i^{e_1}-1\}$, which is described as follow:
\begin{enumerate}
\item Let $x=\log_gh$ ($x=x_i$, $g=g_i$, $h=h_i$ from previous part), where $g=p^e$, and first initialize $x_0=0$.
\item Set $\gamma=g^{p^{e-1}}$.
\item For each $k\in\{0,\dots,e-1\}$, compute $h_k=(g^{-x_k}h)^{p^{e-1-k}}$, By construction, the order of this element must divide $p$, hence $h_k\in\langle\gamma\rangle$. Then compute $d_k$ such that $\gamma^{d_k}=h_k$ and set $x_{k+1}=x_k+p^kd_k$.
\item Obtain $x=x_e$.
\end{enumerate}

After get all $x_i$, solve the simultaneous congruence $$x\equiv x_i \mod p_i^{e_i},i\in\{1,\dots,r\}$$

according to Chinese reminder theorem to get $x=\log_gh$.\\

As an example, we try to find $\log_3 3344$ in $G=U(Z/24389Z).$ Note that $24389=29^3$, so the order $n=28^3=2^6\cdot7^3$.
$$\varphi(85)=2^6$$
$$\varphi()=7^3$$

And 3 is a generator of $G$, so we can get 
\begin{align*}
g_1\equiv 3^{7^3}\equiv 62 &\mod 85\\
h_1\equiv 3344^{7^3}\equiv 24 &\mod 85\\
g_2\equiv 3^{2^6}\equiv 225 &\mod 342\\
h_2\equiv 3344^{2^6}\equiv 76 &\mod 342
\end{align*}

First, for $p=2$, $e=6$, $g=62$ and $h=24$, we should determine $x=\log_gh$ in $G=U(Z/85Z)$. We can get
$$\gamma\equiv 62^{2^5} \equiv 1 \mod 85$$

$$
\begin{array}{ccc}
h_0 \equiv (62^{0}\cdot 24)^{2^5} \equiv 1 \mod 85, & d_0=1, & x_1\equiv 1 \mod 85 \\
\end{array}
$$

$$$$
$$$$

\section{Elgamal}
\begin{enumerate}[(a)]
\item
If the polynomial $X^3+2X^2+1$ is reducible in $F_3[x]$, it can be factored as $$X^3+2X^2+1=(X+A)(X^2+BX+C)=X^3+A(B+1)X^2+(B+C)X+AC$$
There are two possible pairs of $(A,C)$, which are $(1,1)$ and $(2,2)$ so that $AC=1$.

First, if $A=C=1$, then $B=2$, but $A(B+1)=0\neq 2$, so it is wrong.

Second, if $A=C=2$, then $B=1$, but $A(B+1)=1\neq2$, so it is also wrong.

Then we can conclude that $X^3+2X^2+1$ is irreducible in $F_3[x]$.

According to Theorem 2.38, $X^3+2X^2+1$ is an irreducible polynomial of degree 3 in $F_3[x]$, let $F_{3^3}$ be the set of all the polynomial of degree less than 3 in $F_3[x]$, then $F_{3^3}$ is a finite field with $3^3=27$ elements.

\item

We can use 26 lower-case letters and define a map $\xi \leftrightarrow f(\xi)$, where $\xi$ is one of 26 letters. That is, $a \leftrightarrow 1$, $b \leftrightarrow 2$, \dots, $z \leftrightarrow 26$. Then we can define three variables $\alpha$, $\beta$, $\gamma$ so that
\begin{align*}
\alpha &= f(\xi) {\rm\ div\ } 9 \\
\beta  &= (f(\xi) \mod 9) {\rm\ div\ } 3 \\
\gamma &= f(\xi) \mod 3
\end{align*}
And now we can define the map as $$\xi \to g(\xi): g(\xi)=\alpha X^2+\beta X+\gamma$$ 

\item
Let $P(x)=X^3+2X^2+1$,
\input{ex3/1}
So the order of the subgroup generated by $X$ is 26, and $X$ is a generator of $F_{3^3}$.

\item
Use $X$ as the generator and 11 as the secret key,
$$X^{11}\equiv x-1 \equiv x+2 \mod P(x)$$
So $x+2$ is the public key.

\item
Choose $k=18$, we can get 
$$r \equiv X^{18} \equiv x+1 \mod P(x)$$



\end{enumerate}







\end{document}
